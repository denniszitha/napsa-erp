<!-- Professional Sidebar Component -->
<aside class="sidebar" id="sidebar">
    <!-- Sidebar Header -->
    <div class="sidebar-header">
        <div class="sidebar-logo">
            <img src="{{ url_for('static', filename='napsa-logo.png') }}" alt="NAPSA Logo" class="sidebar-logo-img" />
            <span class="sidebar-logo-text">NAPSA ERM</span>
        </div>
    </div>
    
    <!-- Sidebar Navigation -->
    <nav class="sidebar-nav">
        <!-- Dashboard -->
        <div class="nav-section">
            <div class="nav-section-content">
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'dashboard' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('dashboard.index') }}">
                        <i class="fas fa-th-large"></i>
                        <span>Dashboard</span>
                    </a>
                </div>
            </div>
        </div>
        
        <!-- RISK MANAGEMENT Section -->
        <div class="nav-section">
            <div class="nav-section-header">
                <span class="nav-section-title" style="color: #FFA500;">RISK MANAGEMENT</span>
            </div>
            
            <div class="nav-section-content">
                <!-- Core Risk Functions -->
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'risks' in request.endpoint and 'risk_categories' not in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('risks.index') }}">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>Risk Register</span>
                    </a>
                </div>
                
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'risk_categories' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('risk_categories.index') }}">
                        <i class="fas fa-folder-tree"></i>
                        <span>Risk Categories</span>
                    </a>
                </div>
                
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'matrix' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('matrix.index') }}">
                        <i class="fas fa-th"></i>
                        <span>Risk Matrix</span>
                    </a>
                </div>
                
                <!-- Risk Assessment & Controls -->
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'risk_assessments' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('risk_assessments.index') }}">
                        <i class="fas fa-clipboard-check"></i>
                        <span>Risk Assessments</span>
                    </a>
                </div>
                
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'rcsa' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('rcsa.index') }}">
                        <i class="fas fa-clipboard-list"></i>
                        <span>RCSA</span>
                    </a>
                </div>
                
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'controls' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('controls.index') }}">
                        <i class="fas fa-shield-alt"></i>
                        <span>Controls</span>
                    </a>
                </div>
                
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'treatments' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('treatments.index') }}">
                        <i class="fas fa-medkit"></i>
                        <span>Treatment Plans</span>
                    </a>
                </div>
                
                <!-- Risk Monitoring -->
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'incidents' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('incidents.index') }}">
                        <i class="fas fa-exclamation-circle"></i>
                        <span>Incidents/Loss Events</span>
                    </a>
                </div>
                
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'kri' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('kri.dashboard') }}">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Key Risk Indicators</span>
                    </a>
                </div>
                
                <!-- Risk Analytics -->
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'analytics' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('analytics.index') }}">
                        <i class="fas fa-chart-line"></i>
                        <span>Risk Analytics</span>
                    </a>
                </div>
            </div>
        </div>
        
        <!-- COMPLIANCE & ASSURANCE Section -->
        <div class="nav-section">
            <div class="nav-section-header">
                <span class="nav-section-title" style="color: #90EE90;">COMPLIANCE & ASSURANCE</span>
            </div>
            
            <div class="nav-section-content">
                <!-- Compliance Management -->
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'compliance' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('compliance.index') }}">
                        <i class="fas fa-balance-scale"></i>
                        <span>Compliance Hub</span>
                    </a>
                </div>
                
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'regulations' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('regulations.index') }}">
                        <i class="fas fa-gavel"></i>
                        <span>Regulations</span>
                    </a>
                </div>
                
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'policies' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('policies.index') }}">
                        <i class="fas fa-file-contract"></i>
                        <span>Policies</span>
                    </a>
                </div>
                
                <!-- Audit & Assurance -->
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'audit' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('audit.index') }}">
                        <i class="fas fa-search"></i>
                        <span>Audit Management</span>
                    </a>
                </div>
                
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'assessment_periods' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('assessment_periods.index') }}">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Assessment Periods</span>
                    </a>
                </div>
                
                <!-- Reporting -->
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'reports' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('reports.index') }}">
                        <i class="fas fa-chart-bar"></i>
                        <span>Reports</span>
                    </a>
                </div>
                
                <!-- Governance -->
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'users' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('users.index') }}">
                        <i class="fas fa-users"></i>
                        <span>User Management</span>
                    </a>
                </div>
                
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'departments' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('departments.index') }}">
                        <i class="fas fa-sitemap"></i>
                        <span>Departments</span>
                    </a>
                </div>
                
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'vendors' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('vendors.index') }}">
                        <i class="fas fa-handshake"></i>
                        <span>Vendor Management</span>
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Executive Section -->
        <div class="nav-section">
            <div class="nav-section-header">
                <span class="nav-section-title" style="color: #FFD700;">EXECUTIVE</span>
            </div>
            
            <div class="nav-section-content">
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'executive' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('executive.index') }}">
                        <i class="fas fa-chart-line"></i>
                        <span>Executive Dashboard</span>
                    </a>
                </div>
                
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'bi_tools' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('bi_tools.index') }}">
                        <i class="fas fa-chart-pie"></i>
                        <span>BI Tools</span>
                    </a>
                </div>
                
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'metrics' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('metrics.index') }}">
                        <i class="fas fa-chart-area"></i>
                        <span>Metrics</span>
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Administration Section (Simplified) -->
        <div class="nav-section">
            <div class="nav-section-header">
                <span class="nav-section-title">SYSTEM</span>
            </div>
            
            <div class="nav-section-content">
                {% if current_user and current_user.is_admin() %}
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'settings' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('settings.index') }}">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </a>
                </div>
                
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'system-config' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('risks.system_config') }}">
                        <i class="fas fa-cogs"></i>
                        <span>System Config</span>
                    </a>
                </div>
                {% endif %}
                
                <div class="nav-item">
                    <a class="nav-link {% if request.endpoint and 'notifications' in request.endpoint %}active{% endif %}" 
                       href="{{ url_for('notifications.index') }}">
                        <i class="fas fa-bell"></i>
                        <span>Notifications</span>
                    </a>
                </div>
                
                <div class="nav-item">
                    <a class="nav-link" href="{{ url_for('auth.logout') }}">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Logout</span>
                    </a>
                </div>
            </div>
        </div>
    </nav>
</aside>

<!-- Enhanced styling for Risk/Compliance distinction -->
<style>
/* Keep all your existing styles, add these enhancements */

/* Color-coded section headers */
.nav-section-header .nav-section-title {
    font-size: 12px;
    font-weight: 700;
    padding: 5px 0;
    border-bottom: 2px solid currentColor;
    margin-bottom: 10px;
}

/* Risk section hover effect */
.nav-section:nth-child(2) .nav-link:hover {
    background: linear-gradient(90deg, rgba(255, 165, 0, 0.2), rgba(255, 165, 0, 0.1)) !important;
    border-left: 3px solid #FFA500;
}

/* Compliance section hover effect */
.nav-section:nth-child(3) .nav-link:hover {
    background: linear-gradient(90deg, rgba(144, 238, 144, 0.2), rgba(144, 238, 144, 0.1)) !important;
    border-left: 3px solid #90EE90;
}

/* Executive section hover effect */
.nav-section:nth-child(4) .nav-link:hover {
    background: linear-gradient(90deg, rgba(255, 215, 0, 0.2), rgba(255, 215, 0, 0.1)) !important;
    border-left: 3px solid #FFD700;
}

/* Active states with color coding */
.nav-section:nth-child(2) .nav-link.active::before {
    background: #FFA500;
}

.nav-section:nth-child(3) .nav-link.active::before {
    background: #90EE90;
}

.nav-section:nth-child(4) .nav-link.active::before {
    background: #FFD700;
}
</style>